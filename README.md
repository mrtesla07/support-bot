# рџ¤– Support Bot

[![License](https://img.shields.io/github/license/tonmendon/ton-subdomain)](https://github.com/tonmendon/ton-subdomain/blob/main/LICENSE)
[![Telegram Bot](https://img.shields.io/badge/Bot-grey?logo=telegram)](https://core.telegram.org/bots)
[![Python](https://img.shields.io/badge/Python-3.10-blue.svg)](https://www.python.org/downloads/release/python-3100/)
[![Redis](https://img.shields.io/badge/Redis-Yes?logo=redis&color=white)](https://redis.io/)
[![Docker](https://img.shields.io/badge/Docker-blue?logo=docker&logoColor=white)](https://www.docker.com/)

**Support Bot** вЂ” СЌС‚Рѕ С‚РµР»РµРіСЂР°Рј-Р±РѕС‚ РґР»СЏ РѕСЂРіР°РЅРёР·Р°С†РёРё РїРѕРґРґРµСЂР¶РєРё РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№. РћРЅ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё СЃРѕР·РґР°С‘С‚ С‚РµРјС‹ РІ С„РѕСЂСѓРјРµ РіСЂСѓРїРїС‹, РїРѕСЌС‚РѕРјСѓ РґРёР°Р»РѕРіРё РЅРµ СЃРјРµС€РёРІР°СЋС‚СЃСЏ, Р° РјРѕРґРµСЂР°С‚РѕСЂС‹ РІСЃРµРіРґР° РІРёРґСЏС‚ РєРѕРЅС‚РµРєСЃС‚. Р‘РѕС‚ РїРѕРјРѕРіР°РµС‚ Р±Р»РѕРєРёСЂРѕРІР°С‚СЊ РЅРµР¶РµР»Р°С‚РµР»СЊРЅС‹С… СЃРѕР±РµСЃРµРґРЅРёРєРѕРІ, РІРєР»СЋС‡Р°С‚СЊ В«С‚РёС…РёР№В» СЂРµР¶РёРј, РѕС‚РїСЂР°РІР»СЏС‚СЊ РёРЅС„РѕСЂРјР°С‚РёРІРЅС‹Рµ РѕС‚РІРµС‚С‹ Рё РїРѕРґРґРµСЂР¶РёРІР°С‚СЊ РїРѕСЂСЏРґРѕРє РІ РїРµСЂРµРїРёСЃРєРµ.

Р‘РѕС‚ РЅР°РїРѕРјРЅРёС‚ РєРѕРјР°РЅРґРµ, РµСЃР»Рё РїРѕР»СЊР·РѕРІР°С‚РµР»СЋ РЅРµ РѕС‚РІРµС‚РёР»Рё РІ С‚РµС‡РµРЅРёРµ 5 РјРёРЅСѓС‚, Рё РїРѕР·РІРѕР»СЏРµС‚ Р·Р°РєСЂС‹РІР°С‚СЊ РѕР±СЃСѓР¶РґРµРЅРёРµ РєРѕРјР°РЅРґРѕР№ `/resolve`.



**Рћ Р»РёРјРёС‚Р°С…**:
<blockquote>
РћС„РёС†РёР°Р»СЊРЅС‹С… РѕРіСЂР°РЅРёС‡РµРЅРёР№ РЅРµС‚, РЅРѕ СЃРѕРѕР±С‰РµСЃС‚РІРѕ РґРµР»РёС‚СЃСЏ РѕСЂРёРµРЅС‚РёСЂРѕРІРѕС‡РЅС‹РјРё С†РёС„СЂР°РјРё.<br>
вЂў РЎРѕР·РґР°РЅРёРµ РЅРѕРІС‹С… С‚РµРј вЂ” РґРѕ <b>~20</b> РІ РјРёРЅСѓС‚Сѓ.<br>
вЂў РћР±С‰РµРµ РєРѕР»РёС‡РµСЃС‚РІРѕ С‚РµРј вЂ” РґРѕ <b>~1 000 000</b>.
</blockquote>

<details>
<summary><b>РљРѕРјР°РЅРґС‹ РґР»СЏ Р°РґРјРёРЅРёСЃС‚СЂР°С‚РѕСЂР° (DEV_ID)</b></summary>

* `/newsletter` вЂ” РѕС‚РєСЂС‹С‚СЊ РјРµРЅСЋ СЂР°СЃСЃС‹Р»РєРё.

  Р§РµСЂРµР· СЌС‚Рѕ РјРµРЅСЋ РјРѕР¶РЅРѕ Р·Р°РїСѓСЃРєР°С‚СЊ СЂР°СЃСЃС‹Р»РєРё РїРѕ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏРј.
  **Р’Р°Р¶РЅРѕ**: РєРѕРјР°РЅРґР° РґРѕСЃС‚СѓРїРЅР° С‚РѕР»СЊРєРѕ РІ Р»РёС‡РЅС‹С… СЃРѕРѕР±С‰РµРЅРёСЏС….

* `/greeting` вЂ” РѕС‚РєСЂС‹С‚СЊ РјРµРЅСЋ РЅР°СЃС‚СЂРѕР№РєРё РїСЂРёРІРµС‚СЃС‚РІРёСЏ.

  РџРѕР·РІРѕР»СЏРµС‚ Р·Р°РґР°С‚СЊ РѕС‚РґРµР»СЊРЅС‹Рµ С‚РµРєСЃС‚С‹ РґР»СЏ РєР°Р¶РґРѕРіРѕ СЏР·С‹РєР°: РІС‹Р±РµСЂРёС‚Рµ СЏР·С‹Рє РєРЅРѕРїРєРѕР№, РѕС‚РїСЂР°РІСЊС‚Рµ РЅРѕРІС‹Р№ С‚РµРєСЃС‚ РёР»Рё СЃР±СЂРѕСЃСЊС‚Рµ РµРіРѕ РЅР° СЃС‚Р°РЅРґР°СЂС‚РЅС‹Р№.

</details>

<details>
<summary><b>РљРѕРјР°РЅРґС‹ РІ С‚РµРјР°С… РіСЂСѓРїРїС‹</b></summary>

* `/ban` вЂ” Р·Р°Р±Р»РѕРєРёСЂРѕРІР°С‚СЊ РёР»Рё СЂР°Р·Р±Р»РѕРєРёСЂРѕРІР°С‚СЊ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ. РЈРїСЂР°РІР»СЏРµС‚ С‚РµРј, РґРѕС…РѕРґСЏС‚ Р»Рё СЃРѕРѕР±С‰РµРЅРёСЏ РґРѕ РєРѕРјР°РЅРґС‹ РїРѕРґРґРµСЂР¶РєРё.
* `/silent` вЂ” РІРєР»СЋС‡РёС‚СЊ РёР»Рё РІС‹РєР»СЋС‡РёС‚СЊ С‚РёС…РёР№ СЂРµР¶РёРј. Р’ С‚РёС…РѕРј СЂРµР¶РёРјРµ РѕС‚РІРµС‚С‹ РЅРµ РѕС‚РїСЂР°РІР»СЏСЋС‚СЃСЏ РїРѕР»СЊР·РѕРІР°С‚РµР»СЋ.
* `/information` вЂ” РїРѕРєР°Р·Р°С‚СЊ РёРЅС„РѕСЂРјР°С†РёСЋ Рѕ РїРѕР»СЊР·РѕРІР°С‚РµР»Рµ: ID, РёРјСЏ, СЋР·РµСЂРЅРµР№Рј, СЃС‚Р°С‚СѓСЃ Рё РґР°С‚Сѓ СЂРµРіРёСЃС‚СЂР°С†РёРё.
* `/resolve` вЂ” РѕС‚РјРµС‚РёС‚СЊ С‚РёРєРµС‚ СЂРµС€С‘РЅРЅС‹Рј Рё РѕС‚РєР»СЋС‡РёС‚СЊ РЅР°РїРѕРјРёРЅР°РЅРёСЏ.

</details>

## РљР°Рє РЅР°С‡Р°С‚СЊ

<details>
<summary><b>РџРѕРґРіРѕС‚РѕРІРєР°</b></summary>

1. РЎРѕР·РґР°Р№С‚Рµ Р±РѕС‚Р° С‡РµСЂРµР· [@BotFather](https://t.me/BotFather) Рё СЃРѕС…СЂР°РЅРёС‚Рµ С‚РѕРєРµРЅ (`BOT_TOKEN`).
2. РќР°СЃС‚СЂРѕР№С‚Рµ РіСЂСѓРїРїСѓ Рё РІРєР»СЋС‡РёС‚Рµ РІ РЅРµР№ С‚РµРјС‹.
3. Р”РѕР±Р°РІСЊС‚Рµ Р±РѕС‚Р° РІ РіСЂСѓРїРїСѓ СЃ РїСЂР°РІР°РјРё Р°РґРјРёРЅРёСЃС‚СЂР°С‚РѕСЂР° Рё СЂР°Р·СЂРµС€РёС‚Рµ СѓРїСЂР°РІР»РµРЅРёРµ С‚РµРјР°РјРё.
4. РџСЂРёРіР»Р°СЃРёС‚Рµ РІ РіСЂСѓРїРїСѓ Р±РѕС‚Р° [WhatвЂ™s my Telegram ID?](https://t.me/my_id_bot), С‡С‚РѕР±С‹ СѓР·РЅР°С‚СЊ ID РіСЂСѓРїРїС‹ (`BOT_GROUP_ID`).
5. РџСЂРё РЅРµРѕР±С…РѕРґРёРјРѕСЃС‚Рё РёР·РјРµРЅРёС‚Рµ С‚РµРєСЃС‚С‹ Р±РѕС‚Р° РІ С„Р°Р№Р»Рµ [texts](https://github.com/mrtesla07/support-bot/tree/main/app/bot/utils/texts.py).
6. Р§С‚РѕР±С‹ РґРѕР±Р°РІРёС‚СЊ РЅРѕРІС‹Рµ СЏР·С‹РєРё, РґРѕРїРѕР»РЅРёС‚Рµ [SUPPORTED_LANGUAGES](https://github.com/mrtesla07/support-bot/tree/main/app/bot/utils/texts.py#L5) Рё СЃРѕРѕС‚РІРµС‚СЃС‚РІСѓСЋС‰РёРµ Р±Р»РѕРєРё РІ [data](https://github.com/mrtesla07/support-bot/tree/main/app/bot/utils/texts.py#L33).

</details>

<details>
<summary><b>РЈСЃС‚Р°РЅРѕРІРєР°</b></summary>

РџРѕРЅР°РґРѕР±РёС‚СЃСЏ СЃРѕР±СЃС‚РІРµРЅРЅС‹Р№ СЃРµСЂРІРµСЂ РёР»Рё Р°СЂРµРЅРґРѕРІР°РЅРЅС‹Р№ С…РѕСЃС‚РёРЅРі. РџСЂРѕС‰Рµ РІСЃРµРіРѕ СЂР°Р·РІРµСЂРЅСѓС‚СЊ Р±РѕС‚Р° РІ Docker.

1. РљР»РѕРЅРёСЂСѓР№С‚Рµ СЂРµРїРѕР·РёС‚РѕСЂРёР№:

    ```bash
    git clone https://github.com/mrtesla07/support-bot.git
    ```

2. РџРµСЂРµР№РґРёС‚Рµ РІ РєР°С‚Р°Р»РѕРі РїСЂРѕРµРєС‚Р°:

    ```bash
    cd support-bot
    ```

3. РЎРєРѕРїРёСЂСѓР№С‚Рµ С„Р°Р№Р» РїРµСЂРµРјРµРЅРЅС‹С… РѕРєСЂСѓР¶РµРЅРёСЏ:

    ```bash
    cp .env.example .env
    ```

4. Р—Р°РїРѕР»РЅРёС‚Рµ [.env](#РїРµСЂРµРјРµРЅРЅС‹Рµ-РѕРєСЂСѓР¶РµРЅРёСЏ) СЃРІРѕРёРјРё Р·РЅР°С‡РµРЅРёСЏРјРё:

    ```bash
    nano .env
    ```

5. Р—Р°РїСѓСЃС‚РёС‚Рµ РєРѕРЅС‚РµР№РЅРµСЂС‹:

    ```bash
    docker-compose up --build
    ```

</details>
## Обновление и миграции

При обновлении бота придерживаемся последовательности, чтобы подтянуть свежий код и зависимости:

```bash
docker compose down
git pull
docker compose up -d --build
```

Флаг `--build` пересобирает образ и подставляет новые пакеты из `requirements.txt`. После запуска можно проверить состояние сервиса:

```bash
docker compose logs -f bot
```

Данные Redis лежат в отдельном volume и не удаляются, пока не выполнен `docker compose down -v` или ручное удаление томов.

При старте приложение автоматически запускает миграции (`app/migrations`), которые приводят сохранённые записи в Redis к безопасному виду (санируют отображаемые имена и переименовывают темы). Дополнительных действий от оператора не требуется.


## РџРµСЂРµРјРµРЅРЅС‹Рµ РѕРєСЂСѓР¶РµРЅРёСЏ

<details>
<summary>Р Р°Р·РІРµСЂРЅСѓС‚СЊ СЃРїРёСЃРѕРє</summary>

| РџРµСЂРµРјРµРЅРЅР°СЏ      | РўРёРї  | РћРїРёСЃР°РЅРёРµ                                              | РџСЂРёРјРµСЂ               |
|-----------------|------|-------------------------------------------------------|----------------------|
| `BOT_TOKEN`     | `str`| РўРѕРєРµРЅ Р±РѕС‚Р° РѕС‚ [@BotFather](https://t.me/BotFather)    | `123456:qweRTY`      |
| `BOT_DEV_ID`    | `int`| Telegram ID СЂР°Р·СЂР°Р±РѕС‚С‡РёРєР° РёР»Рё Р°РґРјРёРЅРёСЃС‚СЂР°С‚РѕСЂР°           | `123456789`          |
| `BOT_GROUP_ID`  | `str`| ID РіСЂСѓРїРїС‹, РІ РєРѕС‚РѕСЂРѕР№ СЂР°Р±РѕС‚Р°РµС‚ Р±РѕС‚                     | `-100123456789`      |
| `BOT_EMOJI_ID`  | `str`| ID РєР°СЃС‚РѕРјРЅРѕРіРѕ СЌРјРѕРґР·Рё РґР»СЏ РёРєРѕРЅРєРё С‚РµРјС‹                  | `5417915203100613993`|
| `BOT_RESOLVED_EMOJI_ID` | `str`| Custom emoji ID used for the resolved topic icon | `0000000000000000000`|
| `REDIS_HOST`    | `str`| РҐРѕСЃС‚ РёР»Рё IP СЃРµСЂРІРµСЂР° Redis                             | `redis`              |
| `REDIS_PORT`    | `int`| РџРѕСЂС‚ Redis                                            | `6379`               |
| `REDIS_DB`      | `int`| РќРѕРјРµСЂ Р±Р°Р·С‹ Redis                                      | `1`                  |

<details>
<summary>РЎРїРёСЃРѕРє РїРѕРґРґРµСЂР¶РёРІР°РµРјС‹С… РєР°СЃС‚РѕРјРЅС‹С… СЌРјРѕРґР·Рё</summary>

РЎРїСЂР°РІРѕС‡РЅС‹Р№ СЃРїРёСЃРѕРє emoji ID РѕСЃС‚Р°РІР»РµРЅ РІ РёСЃС…РѕРґРЅРѕРј СЂРµРїРѕР·РёС‚РѕСЂРёРё Рё РјРѕР¶РµС‚ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊСЃСЏ РїСЂРё РЅР°СЃС‚СЂРѕР№РєРµ С‚РµРј.

</details>

</details>


## Р”РѕРЅР°С‚С‹

**TON** вЂ” `UQBm7CuV93ZVRK7MiRHVFosSYOjnmonX_E-bEL8cpNe2_EA4`

**USDT** (TRC-20) вЂ” `TXta4rdPhWrMux5pz8dHW9YHJtZyzvuWTn`

## РљР°Рє РїРѕРјРѕС‡СЊ РїСЂРѕРµРєС‚Сѓ

РќР°С€Р»Рё РѕС€РёР±РєСѓ РёР»Рё С…РѕС‚РёС‚Рµ РґРѕР±Р°РІРёС‚СЊ С„СѓРЅРєС†РёРѕРЅР°Р»СЊРЅРѕСЃС‚СЊ вЂ” СЃРѕР·РґР°Р№С‚Рµ issue РёР»Рё РѕС‚РїСЂР°РІСЊС‚Рµ pull request.

## Р›РёС†РµРЅР·РёСЏ

РџСЂРѕРµРєС‚ СЂР°СЃРїСЂРѕСЃС‚СЂР°РЅСЏРµС‚СЃСЏ РїРѕ [MIT License](LICENSE). РСЃРїРѕР»СЊР·СѓР№С‚Рµ, РёР·РјРµРЅСЏР№С‚Рµ Рё СЂР°СЃРїСЂРѕСЃС‚СЂР°РЅСЏР№С‚Рµ РєРѕРґ РІ СЂР°РјРєР°С… СѓСЃР»РѕРІРёР№ Р»РёС†РµРЅР·РёРё.
